
const cardObjectDefinition2 = [
    {id:1, imagePath:'/images/2_of_clubs.png', suit:'c', rank:2},
    {id:2, imagePath:'/images/3_of_clubs.png', suit:'c', rank:3},
    {id:3, imagePath:'/images/4_of_clubs.png', suit:'c', rank:4},
    {id:4, imagePath:'/images/5_of_clubs.png', suit:'c', rank:5},
    {id:5, imagePath:'/images/6_of_clubs.png', suit:'c', rank:6},
    {id:6, imagePath:'/images/7_of_clubs.png', suit:'c', rank:7},
    {id:7, imagePath:'/images/8_of_clubs.png', suit:'c', rank:8},
    {id:8, imagePath:'/images/9_of_clubs.png', suit:'c', rank:9},
    {id:9, imagePath:'/images/10_of_clubs.png', suit:'c', rank:10},
    {id:10, imagePath:'/images/jack_of_clubs2.png', suit:'c', rank:11},
    {id:11, imagePath:'/images/queen_of_clubs2.png', suit:'c', rank:12},
    {id:12, imagePath:'/images/king_of_clubs2.png', suit:'c', rank:13},
    {id:13, imagePath:'/images/ace_of_clubs.png', suit:'c', rank:14},
    {id:14, imagePath:'/images/2_of_hearts.png', suit:'h', rank:2},
    {id:15, imagePath:'/images/3_of_hearts.png', suit:'h', rank:3},
    {id:16, imagePath:'/images/4_of_hearts.png', suit:'h', rank:4},
    {id:17, imagePath:'/images/5_of_hearts.png', suit:'h', rank:5},
    {id:18, imagePath:'/images/6_of_hearts.png', suit:'h', rank:6},
    {id:19, imagePath:'/images/7_of_hearts.png', suit:'h', rank:7},
    {id:20, imagePath:'/images/8_of_hearts.png', suit:'h', rank:8},
    {id:21, imagePath:'/images/9_of_hearts.png', suit:'h', rank:9},
    {id:22, imagePath:'/images/10_of_hearts.png', suit:'h', rank:10},
    {id:23, imagePath:'/images/jack_of_hearts2.png', suit:'h', rank:11},
    {id:24, imagePath:'/images/queen_of_hearts2.png', suit:'h', rank:12},
    {id:25, imagePath:'/images/king_of_hearts2.png', suit:'h', rank:13},
    {id:26, imagePath:'/images/ace_of_hearts.png', suit:'h', rank:14},
    {id:27, imagePath:'/images/2_of_spades.png', suit:'s', rank:2},
    {id:28, imagePath:'/images/3_of_spades.png', suit:'s', rank:3},
    {id:29, imagePath:'/images/4_of_spades.png', suit:'s', rank:4},
    {id:30, imagePath:'/images/5_of_spades.png', suit:'s', rank:5},
    {id:31, imagePath:'/images/6_of_spades.png', suit:'s', rank:6},
    {id:32, imagePath:'/images/7_of_spades.png', suit:'s', rank:7},
    {id:33, imagePath:'/images/8_of_spades.png', suit:'s', rank:8},
    {id:34, imagePath:'/images/9_of_spades.png', suit:'s', rank:9},
    {id:35, imagePath:'/images/10_of_spades.png', suit:'s', rank:10},
    {id:36, imagePath:'/images/jack_of_spades2.png', suit:'s', rank:11},
    {id:37, imagePath:'/images/queen_of_spades2.png', suit:'s', rank:12},
    {id:38, imagePath:'/images/king_of_spades2.png', suit:'s', rank:13},
    {id:39, imagePath:'/images/ace_of_spades2.png', suit:'s', rank:14},
    {id:40, imagePath:'/images/2_of_diamonds.png', suit:'d', rank:2},
    {id:41, imagePath:'/images/3_of_diamonds.png', suit:'d', rank:3},
    {id:42, imagePath:'/images/4_of_diamonds.png', suit:'d', rank:4},
    {id:43, imagePath:'/images/5_of_diamonds.png', suit:'d', rank:5},
    {id:44, imagePath:'/images/6_of_diamonds.png', suit:'d', rank:6},
    {id:45, imagePath:'/images/7_of_diamonds.png', suit:'d', rank:7},
    {id:46, imagePath:'/images/8_of_diamonds.png', suit:'d', rank:8},
    {id:47, imagePath:'/images/9_of_diamonds.png', suit:'d', rank:9},
    {id:48, imagePath:'/images/10_of_diamonds.png', suit:'d', rank:10},
    {id:49, imagePath:'/images/jack_of_diamonds2.png', suit:'d', rank:11},
    {id:50, imagePath:'/images/queen_of_diamonds2.png', suit:'d', rank:12},
    {id:51, imagePath:'/images/king_of_diamonds2.png', suit:'d', rank:13},
    {id:52, imagePath:'/images/ace_of_diamonds.png', suit:'d', rank:14},
    {id:53, imagePath:'/images/red_joker.png', suit:'c', rank:2}
]

const cardObjectDefinition = [
    {id:2, imagePath:'/images/3_of_clubs.png', suit:'c', rank:3},
    {id:3, imagePath:'/images/4_of_clubs.png', suit:'c', rank:4},
    {id:4, imagePath:'/images/5_of_clubs.png', suit:'c', rank:5},
    {id:5, imagePath:'/images/6_of_clubs.png', suit:'c', rank:6},
    {id:6, imagePath:'/images/7_of_clubs.png', suit:'c', rank:7},
    {id:7, imagePath:'/images/8_of_clubs.png', suit:'c', rank:8},
    {id:8, imagePath:'/images/9_of_clubs.png', suit:'c', rank:9},
    {id:9, imagePath:'/images/10_of_clubs.png', suit:'c', rank:10},
    {id:10, imagePath:'/images/jack_of_clubs2.png', suit:'c', rank:11},
    {id:11, imagePath:'/images/queen_of_clubs2.png', suit:'c', rank:12},
    {id:12, imagePath:'/images/king_of_clubs2.png', suit:'c', rank:13},
    {id:13, imagePath:'/images/ace_of_clubs.png', suit:'c', rank:14},
    {id:15, imagePath:'/images/3_of_hearts.png', suit:'h', rank:3},
    {id:16, imagePath:'/images/4_of_hearts.png', suit:'h', rank:4},
    {id:17, imagePath:'/images/5_of_hearts.png', suit:'h', rank:5},
    {id:18, imagePath:'/images/6_of_hearts.png', suit:'h', rank:6},
    {id:19, imagePath:'/images/7_of_hearts.png', suit:'h', rank:7},
    {id:20, imagePath:'/images/8_of_hearts.png', suit:'h', rank:8},
    {id:21, imagePath:'/images/9_of_hearts.png', suit:'h', rank:9},
    {id:22, imagePath:'/images/10_of_hearts.png', suit:'h', rank:10},
    {id:23, imagePath:'/images/jack_of_hearts2.png', suit:'h', rank:11},
    {id:24, imagePath:'/images/queen_of_hearts2.png', suit:'h', rank:12},
    {id:25, imagePath:'/images/king_of_hearts2.png', suit:'h', rank:13},
    {id:26, imagePath:'/images/ace_of_hearts.png', suit:'h', rank:14},
    {id:28, imagePath:'/images/3_of_spades.png', suit:'s', rank:3},
    {id:29, imagePath:'/images/4_of_spades.png', suit:'s', rank:4},
    {id:30, imagePath:'/images/5_of_spades.png', suit:'s', rank:5},
    {id:31, imagePath:'/images/6_of_spades.png', suit:'s', rank:6},
    {id:32, imagePath:'/images/7_of_spades.png', suit:'s', rank:7},
    {id:33, imagePath:'/images/8_of_spades.png', suit:'s', rank:8},
    {id:34, imagePath:'/images/9_of_spades.png', suit:'s', rank:9},
    {id:35, imagePath:'/images/10_of_spades.png', suit:'s', rank:10},
    {id:36, imagePath:'/images/jack_of_spades2.png', suit:'s', rank:11},
    {id:37, imagePath:'/images/queen_of_spades2.png', suit:'s', rank:12},
    {id:38, imagePath:'/images/king_of_spades2.png', suit:'s', rank:13},
    {id:39, imagePath:'/images/ace_of_spades2.png', suit:'s', rank:14},
    {id:41, imagePath:'/images/3_of_diamonds.png', suit:'d', rank:3},
    {id:42, imagePath:'/images/4_of_diamonds.png', suit:'d', rank:4},
    {id:43, imagePath:'/images/5_of_diamonds.png', suit:'d', rank:5},
    {id:44, imagePath:'/images/6_of_diamonds.png', suit:'d', rank:6},
    {id:45, imagePath:'/images/7_of_diamonds.png', suit:'d', rank:7},
    {id:46, imagePath:'/images/8_of_diamonds.png', suit:'d', rank:8},
    {id:47, imagePath:'/images/9_of_diamonds.png', suit:'d', rank:9},
    {id:48, imagePath:'/images/10_of_diamonds.png', suit:'d', rank:10},
    {id:49, imagePath:'/images/jack_of_diamonds2.png', suit:'d', rank:11},
    {id:50, imagePath:'/images/queen_of_diamonds2.png', suit:'d', rank:12},
    {id:51, imagePath:'/images/king_of_diamonds2.png', suit:'d', rank:13},
    {id:52, imagePath:'/images/ace_of_diamonds.png', suit:'d', rank:14}
]

const wildsObjectDefinition = 
[
    {id:1, imagePath:'/images/2_of_clubs.png', suit:'c', rank:2},
    {id:14, imagePath:'/images/2_of_hearts.png', suit:'h', rank:2},
    {id:27, imagePath:'/images/2_of_spades.png', suit:'s', rank:2},
    {id:40, imagePath:'/images/2_of_diamonds.png', suit:'d', rank:2},
    {id:53, imagePath:'/images/red_joker.png', suit:'c', rank:2}
]

const cardBackImgPath = '/images/Card-back.png'

const cardContainerElem = document.querySelector('.card-container')

let playeranddealerhand = []
let handarrayindex = 10

let cards = []

let cardPositions = []

let gameInProgress = false
let animinProgress = false

let score = 0
let roundnum = 0
let maxrounds = 6

const currentGameStatusElem = document.querySelector('.current-status')
const winColor = "green"
const loseColor = "red"
const primaryColor = "black"

const playGameButtonElem = document.getElementById('playGame')
const dpselectedHandElem = document.querySelector('#hands')
const playerselectedHandElem = document.querySelector('#hands2')
const wlpselectedElem = document.querySelector('#wlp')
const submitButtonElem = document.getElementById('submit')
const nextButtonElem = document.getElementById('Next')
const modeselectElem = document.querySelector('#mode')

const scoreContainerElem = document.querySelector('.header-score-container')
const scoreElem = document.querySelector('.score')
const roundContainerElem = document.querySelector('.header-round-container')
const roundElem = document.querySelector('.round')

function getRandomCards(cardarray,count)
{
    const scrambled = cardarray.sort(() => Math.random() - 0.5);
    const scrambled2 = scrambled.sort(() => Math.random() - 0.5);
    const scrambled3 = scrambled2.sort(() => Math.random() - 0.5);
    const scrambled4 = scrambled3.sort(() => Math.random() - 0.5);
    return scrambled4.slice(0,count)
}

updateStatusElement(scoreContainerElem, "none")
updateStatusElement(roundContainerElem, "none")
playGameButtonElem.addEventListener('click', ()=>{
    if(cards.length == 0)
        {
            loadGame()
        }
    else
    {
        cleanup()
        nextButtonElem.removeEventListener('click',startRound)
        loadGame()  
    }
    })

function chooseHand()
{
    if(canChooseHand())
        {

        }
}

function updateScore()
{
    score += 1
}

function canChooseHand()
{
    return gameInProgress == true && !animinProgress
}
function updateStatusElement(elem, display, color, innerHTML)
{
    elem.style.display = display
    if(arguments.length > 2)
    {
        elem.style.color = color
        elem.innerHTML = innerHTML
    }
}
function evaluateHandChoice()
{
    submitButtonElem.disabled = false
    let dphand = []
    dphand = playeranddealerhand.slice(0,5)
    let playerhand = []
    playerhand = playeranddealerhand.slice(handarrayindex - 5,handarrayindex)
    const{ handresult: dphandresult, mainhand: dpmainhand, highcards: dphighcards, natural: dpnatural} = evaluateHandsProcessing(dphand)
    const{ handresult: playerhandresult, mainhand: playermainhand, highcards: playerhighcards, natural: playernatural} = evaluateHandsProcessing(playerhand)
    winner = compareHands(dphandresult,dpmainhand,dphighcards,playerhandresult,playermainhand,playerhighcards)
    submitButtonElem.addEventListener('click', ()=>{
        if(dpselectedHandElem.value == dphandresult && playerselectedHandElem.value == playerhandresult && wlpselectedElem.value == winner)
            {
                updateStatusElement(currentGameStatusElem, "block", winColor, `Correct! The DP hand is ${dphandresult} and The Player's hand is ${playerhandresult}. When ready please hit Next Hand.`)
                score += 1
                nextButtonElem.disabled = false
                submitButtonElem.disabled = true
                //updateStatusElement(scoreElem,"block",primaryColor,`Score <span class='badge'>${score}</span>`)

            }
        else
            {
                updateStatusElement(currentGameStatusElem, "block", loseColor, `Incorrect! The DP hand is ${dphandresult} and The Player's hand is ${playerhandresult}. When ready please hit Next Hand.`)
                nextButtonElem.disabled = false
                submitButtonElem.disabled = true
            }
    }, { once: true})
    handarrayindex += 5
}
function evaluateHandsProcessing(hand)
{
    let wilds = 0
    let H = 0
    let L = 0
    let SS = 0
    let highestduplicates = 0
    let sortedhand = []
    let paircount = 0
    sortedhand = hand.sort((a,b) => {
        return a.rank - b.rank
    })
    console.log("break")
    H = hand[4].rank
    nextH = hand[3].rank
    tempcount = 0
    for (let i =0; i < hand.length; i++)
        {
            if(hand[i].rank == 2)
            {
                wilds += 1
            }
            else
            {
                L = hand[i].rank
                break
            }
        }
    let nowilds = hand.slice(wilds,5)
    const dupcounts = {}
    const suitcounts = {}
    nowilds.forEach(function (x) 
    {
        dupcounts[x.rank] = (dupcounts[x.rank] || 0) + 1;
        suitcounts[x.suit] = (suitcounts[x.suit] || 0) + 1;
    })
    Object.values(dupcounts).forEach((value) => {
        if(value > highestduplicates)
            {
                highestduplicates = value
            }
        if(value == 2)
            {
                paircount += 1
            }
    })
    Object.values(suitcounts).forEach((value) => {
        if(value > SS)
            {
                SS = value
            }
    })
    let handresult = evaluateHandFinal(wilds, H, L, SS, highestduplicates, paircount, nextH)
    const handOrder = {"High Card": 0 , "Pair": 1, "Two Pair": 2, "Trips": 3, "Straight": 4, "Flush" : 5, "Full House": 6, "Quads": 7, "Straight Flush": 8, "Quints": 9, "Royal Flush": 10, "Five Wilds": 11 }
    let highcards = []
    let mainhand = []
    //natural if 0 means its wild payout if 1 its natural
    let natural = 0
    switch(handOrder[handresult])
    {
        case 0:
            highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
            highcards = highcards.map(Number)
            break

        case 1:
            if(wilds == 0)
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 2)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                mainhand = mainhand.map(Number)
                highcards = highcards.map(Number)
                break
            }
            else
            {
                mainhand.push(H)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                highcards = highcards.map(Number)
                highcards = highcards.filter(element => element !== H);
                break
            }
        case 2:
            mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 2)
            mainhand = mainhand.map(Number)
            highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
            highcards = highcards.map(Number)
            break
        case 3:
            if(wilds == 0)
            {
                natural = 1
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 3)
                mainhand = mainhand.map(Number)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                highcards = highcards.map(Number)
                break
            }
            else if(wilds == 1)
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 2)
                mainhand = mainhand.map(Number)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                highcards = highcards.map(Number)
                break
            }
            else
            {
                mainhand.push(H)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                highcards = highcards.map(Number)
                highcards = highcards.filter(element => element !== H);
                break
            }
        case 4:
            mainhand.push(L)
            if(wilds <= 1 && (H == 6 || H == 5))
            {
                natural = 1
            }
            break
        case 5:
            if(wilds == 0)
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                mainhand = mainhand.map(Number)
                natural = 1
                break
            }
            else if(wilds == 1)
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                mainhand = mainhand.map(Number)
                mainhand.push(14)
                wildsuitchecker = hand.filter(element => element.rank == 2)
                if(wildsuitchecker[0].suit == nowilds[0].suit)
                {
                    natural = 1
                }
                break
            }
            else
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                mainhand = mainhand.map(Number)
                mainhand.push(14)
                mainhand.push(14)
                break
            }
        case 6:
            if(wilds == 0)
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 3)
                mainhand = mainhand.map(Number)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 2)
                highcards = highcards.map(Number)
                natural = 1
                break
            }
            else
            {
                mainhand.push(H)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 2)
                highcards = highcards.map(Number)
                highcards = highcards.filter(element => element !== H);
                break
            }
        case 7:
            if(wilds == 0)
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 4)
                mainhand = mainhand.map(Number)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                highcards = highcards.map(Number)
                natural = 1
                break
            }
            else if(wilds == 1)
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 3)
                mainhand = mainhand.map(Number)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                highcards = highcards.map(Number)
                break
            }
            else if(wilds == 2)
            {
                mainhand = Object.keys(dupcounts).filter(k => dupcounts[k] === 2)
                mainhand = mainhand.map(Number)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                highcards = highcards.map(Number)
                break
            }
            else
            {
                mainhand.push(H)
                highcards = Object.keys(dupcounts).filter(k => dupcounts[k] === 1)
                highcards = highcards.map(Number)
                highcards = highcards.filter(element => element !== H);
                break
            }
        case 8:
            mainhand.push(L)
            wildsuitchecker = hand.filter(element => element.rank == 2)
                if(wildsuitchecker[0].suit == nowilds[0].suit)
                {
                    natural = 1
                }
            break
        case 9:
            mainhand.push(H)
            break
    }
    mainhand.sort((a,b) => b - a)
    highcards.sort((a,b) => b - a)
    return{handresult, mainhand, highcards, natural} 
}
function evaluateHandFinal(wilds, H, L, SS, highestduplicates, paircount, nextH)
{
    if(wilds == 5)
        {
            return "Five Wilds"
        }
    else if (wilds == 4)
        {
            if(H >= 10)
                {
                    return "Royal Flush"
                }
            else
            {
                return "Quints"
            }
        }
    else if(wilds == 3)
        {
            if(highestduplicates == 1)
                {
                    if((H - L) <= 4 || (H == 14 && (nextH <= 5) && (nextH - L <= 3)))
                        {
                            if(SS == 2)
                                {
                                    if(L >= 10)
                                        {
                                            return "Royal Flush"
                                        }
                                    else
                                        {
                                            return "Straight Flush"
                                        }
                                }
                            else
                                {
                                    return "Quads"
                                }
                        }
                    else
                    {
                        return "Quads"
                    }
                }
            else 
            {
                return "Quints"
            }
        }
    else if(wilds == 2)
        {
            if(highestduplicates == 1)
                {
                    if(H - L <= 4 || (H == 14 && (nextH <= 5) && (nextH - L <= 3)))
                        {
                            if(SS == 3)
                                {
                                    if(L >= 10)
                                        {
                                            return "Royal Flush"
                                        }
                                    else
                                        {
                                            return "Straight Flush"
                                        }
                                }
                            else 
                                {
                                    return "Straight"
                                }
                        }
                    else
                        {
                            if(SS == 3)
                                {
                                    return "Flush"
                                }
                            else
                                {
                                    return "Trips"
                                }
                        }
                }
            else
            {
                if(highestduplicates == 2)
                    {
                        return "Quads"
                    }
                else
                    {
                        return "Quints"
                    }
            }
        }
    else if(wilds == 1)
        {
            if(highestduplicates == 1)
                {
                    if((H - L <= 4) || ((H == 14) && (nextH <= 5) && (nextH - L <= 3)))
                        {
                            if(SS == 4)
                                {
                                    if(L >= 10)
                                        {
                                            return "Royal Flush"
                                        }
                                    else
                                        {
                                            return "Straight Flush"
                                        }
                                }
                            else
                                {
                                    return "Straight"
                                }
                        }
                    else
                        {
                            if(SS == 4)
                                {
                                    return "Flush"
                                }
                            else
                                {
                                    return "Pair"
                                }
                        }
                }
            else
                {
                    if(highestduplicates == 2)
                        {
                            if(paircount == 1)
                                {
                                    return "Trips"
                                }
                            else
                                {
                                    return "Full House"
                                }
                        }
                    else if(highestduplicates == 3)
                        {
                            return "Quads"
                        }
                    else
                        {
                            return "Quints"
                        }
                }
        }
    else
    {
       if(highestduplicates == 1)
        {
            if(H - L == 4)
                {
                    if(SS == 5)
                        {
                            if(L == 10)
                                {
                                    return "Royal Flush"
                                }
                            else
                                {
                                    return "Straight Flush"
                                }
                        }
                    else
                        {
                            return "Straight"
                        }
                }
            else
                {
                    if(SS == 5)
                        {
                            return "Flush"
                        }
                    else
                        {
                            return "High Card"
                        }
                }
        }
        else
        {
            if(highestduplicates == 2)
                {
                    if(paircount == 1)
                        {
                            return "Pair"
                        }
                    else
                        {
                            return "Two Pair"
                        }
                }
            else if(highestduplicates == 3)
                {
                    if(paircount == 1)
                        {
                            return "Full House"
                        }
                    else 
                        {
                            return "Trips"
                        }
                }
            else
                {
                    return "Quads"    
                }      
        }
    }
}
function compareHands(dphandresult, dpmainhand, dphighcards, playerhandresult, playermainhand, playerhighcards)
{
    //who wins 1 = Dp 2 = Player 0 = push
    let whowins = 0
    const handOrder = {"High Card": 0 , "Pair": 1, "Two Pair": 2, "Trips": 3, "Straight": 4, "Flush" : 5, "Full House": 6, "Quads": 7, "Straight Flush": 8, "Quints": 9, "Royal Flush": 10, "Five Wilds": 11 }
    if(handOrder[dphandresult] > handOrder[playerhandresult])
    {
        whowins = 1
    }
    else if(handOrder[dphandresult] < handOrder[playerhandresult])
    {
        whowins = 2
    }
    else
    {
        switch(handOrder[dphandresult])
        {
            case 0:
                for(let i =0; i < dphighcards.length; i++)
                    {
                        if(dphighcards[i] > playerhighcards[i])
                        {
                            whowins = 1
                            break
                        }
                        else if(dphighcards[i] < playerhighcards[i])
                        {
                            whowins = 2
                            break
                        }
                    }
                break
            case 1:
            case 3:
            case 6:
            case 7:
                if(dpmainhand[0] > playermainhand[0])
                {
                    whowins = 1
                    break
                }
                else if(dpmainhand[0] < playermainhand[0])
                {
                    whowins = 2
                    break
                }
                else
                {
                    for(let i =0; i < dphighcards.length; i++)
                    {
                        if(dphighcards[i] > playerhighcards[i])
                        {
                            whowins = 1
                            break
                        }
                        else if(dphighcards[i] < playerhighcards[i])
                        {
                            whowins = 2
                            break
                        }
                    }
                    break
                }
            case 4:
            case 8:
            case 9:
                if(dpmainhand[0] > playermainhand[0])
                {
                    whowins = 1
                    break
                }
                else if(dpmainhand[0] < playermainhand[0])
                {
                    whowins = 2
                    break
                }
                break
            case 5:
                for(let i =0; i < dpmainhand.length; i++)
                    {
                        if(dpmainhand[i] > playermainhand[i])
                        {
                            whowins = 1
                            break
                        }
                        else if(dpmainhand[i] < playermainhand[i])
                        {
                            whowins = 2
                            break
                        }
                    }
                break
            case 2:
                for(let i =0; i < dpmainhand.length; i++)
                    {
                        if(dpmainhand[i] > playermainhand[i])
                        {
                            whowins = 1
                            break
                        }
                        else if(dpmainhand[i] < playermainhand[i])
                        {
                            whowins = 2
                            break
                        }
                    }
                if(whowins > 0)
                {
                    break
                }
                else
                {
                    for(let i =0; i < dphighcards.length; i++)
                    {
                        if(dphighcards[i] > playerhighcards[i])
                        {
                            whowins = 1
                            break
                        }
                        else if(dphighcards[i] < playerhighcards[i])
                        {
                            whowins = 2
                            break
                        }
                    }
                    break
                }
             
        }
    }
    if(whowins == 1)
    {
        return "LOSE"
    }
    else if(whowins == 2)
    {
        return "WIN"
    }
    else
    {
        return "PUSH"
    }
}

function loadGame()
{
    submitButtonElem.disabled = true
    nextButtonElem.disabled = true
    updateStatusElement(modeselectElem,"none")
    createCards()
    cards = document.querySelectorAll('.card')
    lazywaytostartcardswithbackfacing(cards,true)
    //playGameButtonElem.addEventListener('click', ()=>startGame())
    startGame()
}

function startGame()
{
    initializeNewGame()
    startRound()
    nextButtonElem.addEventListener('click',startRound)
}
function initializeNewGame()
{
    score = 0
    roundnum = 0
    handarrayindex = 10
    animinProgress = false


    //updateStatusElement(scoreContainerElem,"flex")
    //updateStatusElement(roundContainerElem,"flex")

    //updateStatusElement(scoreElem,"block",primaryColor,`Score <span class='badge'>${score}</span>`)
    //updateStatusElement(roundElem,"block",primaryColor,`Round <span class='badge'>${roundnum}</span>`)
}
function startRound()
{   
    initializeNewRound()
    console.log("newround")
    if(roundnum == 1)
        {
            CollectCards()

            setTimeout(() => {
                dealCards()
                flipCards(true)
            }, 1000)
            setTimeout(() => {
                evaluateHandChoice()
            }, 2500)
            
        }
    else if(roundnum == 7)
        {
            gameOver()
            lazywaytostartcardswithbackfacing(cards,true)
            CollectCards()
            //updateStatusElement(currentGameStatusElem, "block", winColor, `Thank you for playing your final score was ${score} out of 6 Good Job! Hit Play Game To play again!`)
            updateStatusElement(currentGameStatusElem, "block", winColor, `Thank you for playing! Hit Play Game To play again!`)
            updateStatusElement(modeselectElem, "block")
            console.log("finish")

        }
    else
        {
            updateCards()
            console.log("break2")
            cards = document.querySelectorAll('.card')
            console.log(cards)
            lazywaytostartcardswithbackfacing2(cards,true)
            setTimeout(() => {
                dealCards()
                flipCertainCards(true)
            }, 1000)
            setTimeout(() => {
                evaluateHandChoice()
            }, 2000)
        }
}
function initializeNewRound()
{
    roundnum += 1
    console.log("activated")
    playGameButtonElem.disabled = true
    nextButtonElem.disabled = true

    gameInProgress = true
    animinProgress = true

    updateStatusElement(currentGameStatusElem, "block", primaryColor, "Select The DP Hand, Select The Player Hand, Select if the Player Wins, Loses, or Pushes and hit Submit when ready.")
    //updateStatusElement(roundElem, "block", primaryColor, `Round <span class='badge'>${roundnum}</span>`)

}

function gameOver()
{
    updateStatusElement(scoreContainerElem, "none")
    updateStatusElement(roundContainerElem, "none")
    nextButtonElem.disabled = true
    submitButtonElem.disabled = true
    playGameButtonElem.disabled = false

}

const collapsedGridAreaTemplate = '"a a a a a" "a a a a a"'
const regularGridAreaTemplate = '"a b c d e" "f g h i j"'
const semiCollapsedGridAreaTemplate = '"a b c d e" "f f f f f"'
const cardCollectionCellClass = ".card-pos-a"
const semiCardCollectionCellClass = ".card-pos-f"

function semiCollectCards()
{
    transformGridArea(semiCollapsedGridAreaTemplate)
    updateCardsToGridCellArea(semiCardCollectionCellClass)

}
function updateCardsToGridCellArea(cellPositionClassName)
{
    const cellPosistionElem = document.querySelector(cellPositionClassName)
    
    cards.forEach((card) =>{
        if(card.id == cards[0].id)
        {
            addChildElement(document.querySelector('.card-pos-a'),card)
        }
        else if(card.id == cards[1].id)
        {
            addChildElement(document.querySelector('.card-pos-b'),card)
        }
        else if(card.id == cards[2].id)
        {
            addChildElement(document.querySelector('.card-pos-c'),card)
        }
        else if(card.id == cards[3].id)
        {
            addChildElement(document.querySelector('.card-pos-d'),card)
        }
        else if(card.id == cards[4].id)
        {
            addChildElement(document.querySelector('.card-pos-e'),card)
        }
        else
        {
            addChildElement(cellPosistionElem,card)
        }
    })
    
}

function CollectCards()
{
    transformGridArea(collapsedGridAreaTemplate)
    addCardsToGridAreaCell(cardCollectionCellClass)
}
function transformGridArea(areas)
{
    cardContainerElem.style.gridTemplateAreas = areas
}
function addCardsToGridAreaCell(cellPositionClassName)
{
    const cellPosistionElem = document.querySelector(cellPositionClassName)

    cards.forEach((card, index) => {
        addChildElement(cellPosistionElem, card)
    })
}


function flipCard(card, flipToBack)
{
    const innerCardElem = card.firstChild

    if(flipToBack && !innerCardElem.classList.contains('flip-it'))
        {
            innerCardElem.classList.add('flip-it')
        }
    else if(innerCardElem.classList.contains('flip-it'))
        {
            innerCardElem.classList.remove('flip-it')
        }
}

function flipCards(flipToBack)
{
    cards.forEach((card, index)=> {
        setTimeout(() => {
            flipCard(card,flipToBack)
        }, index * 100)
    })
}

function flipCertainCards(flipToBack)
{
    cards.forEach((card, index) => {
        if(index > 4)
            {
                setTimeout(() => {
                flipCard(card,flipToBack)
                }, (index-5) * 100)
            }
    })
}

function lazywaytostartcardswithbackfacing(cardarray,flipToBack)
{
    cardarray.forEach((card) =>
        {
            flipCard(card,flipToBack)
        })
}

function lazywaytostartcardswithbackfacing2(cardarray,flipToBack)
{
    cardarray.forEach((card, index) =>
        {
            if(index > 4)
                {
                    flipCard(card,flipToBack)
                }
        })
}

function dealCards()
{
    addCardsToAppropriateCell()
    transformGridArea(regularGridAreaTemplate)
}
function addCardsToAppropriateCell()
{
    cards.forEach((card)=>{
        addCardToGridCell(card,cards)
    })
}


function createCards()
{
    console.log(modeselectElem.value)
    if(modeselectElem.value == "fiveWilds")
        {
            const sevenHands = getRandomCards(cardObjectDefinition,30)
            const sevenHands2 = sevenHands.concat(wildsObjectDefinition)
            const scrambled = sevenHands2.sort(() => Math.random() - 0.5);
            const scrambled2 = scrambled.sort(() => Math.random() - 0.5);
            const scrambled3 = scrambled2.sort(() => Math.random() - 0.5);
            const scrambled4 = scrambled3.sort(() => Math.random() - 0.5);
            playeranddealerhand = scrambled4
        }
    else
        {
            const sevenHands = getRandomCards(cardObjectDefinition2,35)
            playeranddealerhand = sevenHands
        }
    let firstround = playeranddealerhand.slice(0,10)
    firstround.forEach((cardItem)=>{
        createCard(cardItem, firstround)
    })
}
function updateCards()
{
    newcardlist = playeranddealerhand.slice(0,5).concat(playeranddealerhand.slice(handarrayindex-5,handarrayindex))
    removeCardElements()
    newcardlist.forEach((cardItem)=>{
        createCard(cardItem, newcardlist)
    })
}

function removeCardElements()
{
    let removecards = document.querySelectorAll('.card-pos-a .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-b .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-c .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-d .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-e .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-f .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-g .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-h .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-i .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    removecards = document.querySelectorAll('.card-pos-j .card');
    removecards[0].remove(); // removes the second .card inside .card-pos-a
    console.log("done")   
}
function cleanup()
{
    let removecards = document.querySelectorAll('.card-pos-a .card');
    removecards.forEach((cards,Index) =>
        {
            removecards[Index].remove()
        })
}

function createCard(cardItem, randomcards)
{   //create dive element for each part of a card
    
    const cardElem = createElement('div')
    const cardInnerElem = createElement('div')
    const cardFrontElem = createElement('div')
    const cardBackElem = createElement('div')

    //create front and back img for a card
    const cardFrontImg = createElement('img')
    const cardBackImg = createElement('img')

    //add class and id to card element
    addClassToElement(cardElem, 'card')
    addIdToElement(cardElem, cardItem.id)

    //add class to inner card element
    addClassToElement(cardInnerElem, 'card-inner')

    //add class to front
    addClassToElement(cardFrontElem, 'card-front')
    //add class to back
    addClassToElement(cardBackElem, 'card-back')

    //add src att and apropriate value to img element - back of card
    addSrcToImageElem(cardBackImg, cardBackImgPath)

    //add src att and apropriate value to img element - front
    addSrcToImageElem(cardFrontImg, cardItem.imagePath)

    //assign class to back image element
    addClassToElement(cardBackImg, 'card-img')

    //assign class to front image element
    addClassToElement(cardFrontImg, 'card-img')

    //assign front and back image as child
    addChildElement(cardFrontElem, cardFrontImg)
    addChildElement(cardBackElem, cardBackImg)

    //assign front and back to inner
    addChildElement(cardInnerElem, cardFrontElem)
    addChildElement(cardInnerElem, cardBackElem)

    //add inner to card
    addChildElement(cardElem, cardInnerElem)

    //add card elem as child elem to appropriate grid cell
    addCardToGridCell(cardElem, randomcards)
}
function initializeCardPositions()
{

}
function createElement(elemType)
{
    return document.createElement(elemType)
}
function addClassToElement(elem, className)
{
    elem.classList.add(className)
}
function addIdToElement(elem, id)
{
    elem.id = id
}
function addSrcToImageElem(imgElem, src)
{
    imgElem.src = src
}
function addChildElement(parentElem, childElem)
{
    parentElem.appendChild(childElem)
}
function addCardToGridCell(card, randomcards)
{
    const cardPositionClassName = mapCardIdToGridCell(card, randomcards)
    console.log(cardPositionClassName)
    const cardPosElem = document.querySelector(cardPositionClassName)
   
    addChildElement(cardPosElem, card)  
}
function mapCardIdToGridCell(card, randomcards)
{
    if(card.id == randomcards[0].id)
        {
            return '.card-pos-a'
        }
    else if(card.id == randomcards[1].id)
        {
            return '.card-pos-b'
        }
    else if(card.id == randomcards[2].id)
        {
            return '.card-pos-c'
        }
    else if(card.id == randomcards[3].id)
        {
            return '.card-pos-d'
        }
    else if(card.id == randomcards[4].id)
        {
            return '.card-pos-e'
        }
    else if(card.id == randomcards[5].id)
        {
            return '.card-pos-f'
        }
    else if(card.id == randomcards[6].id)
        {
            return '.card-pos-g'
        }
    else if(card.id == randomcards[7].id)
        {
            return '.card-pos-h'
        }
    else if(card.id == randomcards[8].id)
        {
            return '.card-pos-i'
        }
    else if(card.id == randomcards[9].id)
        {
            return '.card-pos-j'
        }

}